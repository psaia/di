{"version":3,"file":"","sourceRoot":"","sources":["canvas.js","component.js","controldrawer.js","di.js","dom.js","grid.js","interactions.js","layers.js","marquee.js","shape.js","toolbar.js","types.js","util.js"],"sourcesContent":["\"use strict\";\nvar __extends = (this && this.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    }\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nexports.__esModule = true;\nvar dom = require(\"./dom\");\nvar util = require(\"./util\");\nvar grid_1 = require(\"./grid\");\nvar component_1 = require(\"./component\");\nvar Canvas = /** @class */ (function (_super) {\n    __extends(Canvas, _super);\n    function Canvas() {\n        var _this = _super !== null && _super.apply(this, arguments) || this;\n        _this.width = 0;\n        _this.height = 0;\n        _this.pixelScale = 1;\n        _this.shapes = [];\n        _this.play = function (time) {\n            if (time === void 0) { time = 0; }\n            requestAnimationFrame(_this.play);\n            _this.ctx.clearRect(0, 0, _this.width, _this.height);\n            _this.grid.render();\n            for (var i = 0, l = _this.shapes.length; i < l; i++) {\n                _this.shapes[i].render(_this.ctx, _this.colorPalette);\n            }\n        };\n        return _this;\n    }\n    Canvas.prototype.addShape = function (layer) {\n        this.shapes.push(layer);\n    };\n    Canvas.prototype.onMouseDown = function (fn) {\n        this.mouseDownFn = fn;\n    };\n    Canvas.prototype.onMouseUp = function (fn) {\n        this.mouseUpFn = fn;\n    };\n    Canvas.prototype.onMouseMove = function (fn) {\n        this.mouseMoveFn = fn;\n    };\n    Canvas.prototype.onResize = function (fn) {\n        this.resizeFn = fn;\n    };\n    Canvas.prototype.listen = function (o, evt, fn) {\n        o.addEventListener(evt, fn, false);\n    };\n    Canvas.prototype.resize = function (container) {\n        var _a = dom.getDimensions(container), width = _a.width, height = _a.height;\n        this.width = width;\n        this.height = height;\n        this.grid.setSize(width, height);\n        this.canvas.setAttribute(\"width\", String(width * this.pixelScale));\n        this.canvas.setAttribute(\"height\", String(height * this.pixelScale));\n        this.canvas.width = width * this.pixelScale;\n        this.canvas.height = height * this.pixelScale;\n        this.canvas.style.width = Math.floor(width) + \"px\";\n        this.canvas.style.height = Math.floor(height) + \"px\";\n        if (this.pixelScale > 1) {\n            this.ctx.scale(this.pixelScale, this.pixelScale);\n            this.ctx.translate(0.5, 0.5);\n        }\n    };\n    Canvas.prototype.registerListeners = function (container) {\n        var _this = this;\n        this.listen(this.canvas, \"mousemove\", function (e) {\n            _this.grid.setCursor(util.pt(e.layerX, e.layerY));\n            if (_this.mouseMoveFn) {\n                _this.mouseMoveFn(e);\n            }\n        });\n        this.listen(this.canvas, \"mousedown\", function (e) {\n            if (_this.mouseDownFn) {\n                _this.mouseDownFn(e);\n            }\n        });\n        this.listen(this.canvas, \"mouseup\", function (e) {\n            if (_this.mouseUpFn) {\n                _this.mouseUpFn(e);\n            }\n        });\n        this.listen(window, \"resize\", function () {\n            _this.resize(container);\n            if (_this.resizeFn) {\n                _this.resizeFn();\n            }\n        });\n    };\n    Canvas.prototype.render = function () {\n        var container = dom.section(\"app\");\n        container.style.height = \"100%\";\n        container.style.width = \"100%\";\n        container.style.display = \"relative\";\n        container.style.overflow = \"hidden\";\n        container.style.background = this.colorPalette.stageBg;\n        this.canvas = dom.canvas();\n        this.ctx = this.canvas.getContext(\"2d\");\n        container.appendChild(this.canvas);\n        this.pixelScale = window.devicePixelRatio;\n        this.grid = new grid_1[\"default\"](this.ctx);\n        this.grid.setColor(this.colorPalette.gridColor);\n        this.registerListeners(container);\n        this.rendered(container);\n        this.play();\n        this.resize(container);\n    };\n    return Canvas;\n}(component_1[\"default\"]));\nexports[\"default\"] = Canvas;\n//# sourceMappingURL=canvas.js.map","\"use strict\";\nexports.__esModule = true;\nvar Component = /** @class */ (function () {\n    function Component(defaultPalette) {\n        this.setColorPalette(defaultPalette);\n    }\n    Component.prototype.onRender = function (fn) {\n        this.rendered = fn;\n    };\n    Component.prototype.setColorPalette = function (c) {\n        this.colorPalette = c;\n    };\n    return Component;\n}());\nexports[\"default\"] = Component;\n//# sourceMappingURL=component.js.map","\"use strict\";\nvar __extends = (this && this.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    }\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nexports.__esModule = true;\nvar dom = require(\"./dom\");\nvar component_1 = require(\"./component\");\nvar ControlDrawer = /** @class */ (function (_super) {\n    __extends(ControlDrawer, _super);\n    function ControlDrawer() {\n        return _super !== null && _super.apply(this, arguments) || this;\n    }\n    ControlDrawer.prototype.render = function () {\n        var section = dom.section(\"controldrawer\");\n        section.style.width = \"42px\";\n        section.style.background = this.colorPalette.controldrawerBg;\n        section.style.color = this.colorPalette.controldrawerColor;\n        this.rendered(section);\n    };\n    return ControlDrawer;\n}(component_1[\"default\"]));\nexports[\"default\"] = ControlDrawer;\n//# sourceMappingURL=controldrawer.js.map","\"use strict\";\nexports.__esModule = true;\nvar dom = require(\"./dom\");\nvar controldrawer_1 = require(\"./controldrawer\");\nvar canvas_1 = require(\"./canvas\");\nvar layers_1 = require(\"./layers\");\nvar toolbar_1 = require(\"./toolbar\");\nvar interactions = require(\"./interactions\");\nvar w = window;\nw.di = di;\nvar defaultPalette = {\n    layersBg: \"#111\",\n    layersColor: \"white\",\n    stageBg: \"#000\",\n    stageColor: \"#fff\",\n    gridColor: \"#111\",\n    shapeColor: \"#ccc\",\n    toolbarBg: \"#FFF\",\n    toolbarColor: \"#FFF\",\n    controldrawerBg: \"#690000\",\n    controldrawerColor: \"#FFF\"\n};\nfunction di(parentSelector) {\n    var parent = dom.select(parentSelector);\n    var controldrawer = new controldrawer_1[\"default\"](defaultPalette);\n    var toolbar = new toolbar_1[\"default\"](defaultPalette);\n    var layers = new layers_1[\"default\"](defaultPalette);\n    var canvas = new canvas_1[\"default\"](defaultPalette);\n    controldrawer.onRender(dom.renderer(parent));\n    layers.onRender(dom.renderer(parent));\n    canvas.onRender(dom.renderer(parent));\n    toolbar.onRender(dom.renderer(parent));\n    canvas.render();\n    toolbar.render();\n    layers.render();\n    controldrawer.render();\n    interactions.configure({ canvas: canvas, toolbar: toolbar, layers: layers, controldrawer: controldrawer });\n}\n//# sourceMappingURL=di.js.map","\"use strict\";\nexports.__esModule = true;\nvar prefix = \"di__\";\nfunction renderer(c) {\n    var lastNode = section(\"-\");\n    c.appendChild(lastNode);\n    return function (el) {\n        c.replaceChild(el, lastNode);\n        lastNode = el;\n    };\n}\nexports.renderer = renderer;\nfunction getDimensions(element, inject) {\n    if (inject === void 0) { inject = false; }\n    var dim;\n    if (inject) {\n        var clone = element.cloneNode(true);\n        clone.style.display = \"block\";\n        clone.style.visibility = \"hidden\";\n        document.body.appendChild(clone);\n        dim = clone.getBoundingClientRect();\n        document.body.removeChild(clone);\n    }\n    else {\n        dim = element.getBoundingClientRect();\n    }\n    return {\n        height: dim.height,\n        width: dim.width\n    };\n}\nexports.getDimensions = getDimensions;\nfunction select(selector) {\n    return document.querySelector(selector);\n}\nexports.select = select;\nfunction section(className) {\n    var s = document.createElement(\"section\");\n    s.className = prefix + className;\n    return s;\n}\nexports.section = section;\nfunction ul(className) {\n    if (className === void 0) { className = \"\"; }\n    var ul = document.createElement(\"ul\");\n    ul.className = prefix + className;\n    return ul;\n}\nexports.ul = ul;\nfunction li(className) {\n    if (className === void 0) { className = \"\"; }\n    var li = document.createElement(\"li\");\n    li.className = prefix + className;\n    return li;\n}\nexports.li = li;\nfunction button(className) {\n    if (className === void 0) { className = \"\"; }\n    var button = document.createElement(\"button\");\n    button.className = prefix + className;\n    return button;\n}\nexports.button = button;\nfunction a(className) {\n    if (className === void 0) { className = \"\"; }\n    var a = document.createElement(\"a\");\n    a.className = prefix + className;\n    return a;\n}\nexports.a = a;\nfunction canvas(className) {\n    if (className === void 0) { className = \"\"; }\n    var canvas = document.createElement(\"canvas\");\n    canvas.className = prefix + className;\n    return canvas;\n}\nexports.canvas = canvas;\n//# sourceMappingURL=dom.js.map","\"use strict\";\nexports.__esModule = true;\nvar util = require(\"./util\");\nvar Grid = /** @class */ (function () {\n    function Grid(ctx) {\n        this.density = 10;\n        this.gridActiveColor = \"white\";\n        this.gridColor = \"white\";\n        this.size = {\n            width: 100,\n            height: 100\n        };\n        this.ctx = ctx;\n        this.cursorPt = util.pt();\n    }\n    Grid.prototype.setSize = function (width, height) {\n        this.size = { width: width, height: height };\n        this.render();\n    };\n    Grid.prototype.setCursor = function (p) {\n        this.cursorPt = p;\n    };\n    Grid.prototype.setColor = function (c) {\n        this.gridColor = c;\n    };\n    Grid.prototype.drawCross = function (center) {\n        var size = 7;\n        var htSize = 7;\n        var rightTop = util.pt(center[0] - htSize, center[1] + htSize);\n        var leftBottom = util.pt(center[0] + htSize, center[1] - htSize);\n        var bounds = [rightTop, leftBottom];\n        this.ctx.beginPath();\n        // |\n        this.ctx.moveTo(center[0], center[1] - size);\n        this.ctx.lineTo(center[0], center[1] + size);\n        // --\n        this.ctx.moveTo(center[0] - size, center[1]);\n        this.ctx.lineTo(center[0] + size, center[1]);\n        if (util.withinBound(this.cursorPt, bounds)) {\n            this.closestPt = center;\n            this.ctx.strokeStyle = this.gridActiveColor;\n        }\n        else {\n            this.ctx.strokeStyle = this.gridColor;\n        }\n        this.ctx.lineWidth = 1;\n        this.ctx.stroke();\n    };\n    Grid.prototype.render = function () {\n        var grid = [];\n        var ctx = this.ctx;\n        var w = this.size.width;\n        var h = this.size.height;\n        var padding = 20;\n        var margin = 15;\n        for (var x = padding; x < w - padding; x += margin) {\n            for (var y = padding; y < h - padding; y += margin) {\n                var p = util.pt(x, y);\n                this.drawCross(p);\n                grid.push(p);\n            }\n        }\n        this.grid = grid;\n        return grid;\n    };\n    return Grid;\n}());\nexports[\"default\"] = Grid;\n//# sourceMappingURL=grid.js.map","\"use strict\";\nvar __extends = (this && this.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    }\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nexports.__esModule = true;\nvar marquee_1 = require(\"./marquee\");\nvar util = require(\"./util\");\nvar types_1 = require(\"./types\");\nvar Area;\n(function (Area) {\n    Area[Area[\"Corner\"] = 0] = \"Corner\";\n    Area[Area[\"Center\"] = 1] = \"Center\";\n})(Area || (Area = {}));\nfunction configure(os) {\n    var state = new State();\n    var shell = new Shell(os, state);\n    shell.dombind();\n}\nexports.configure = configure;\nvar State = /** @class */ (function () {\n    function State() {\n    }\n    return State;\n}());\nvar Engine = /** @class */ (function () {\n    function Engine() {\n    }\n    return Engine;\n}());\nvar MarqueeEngine = /** @class */ (function (_super) {\n    __extends(MarqueeEngine, _super);\n    function MarqueeEngine() {\n        return _super !== null && _super.apply(this, arguments) || this;\n    }\n    MarqueeEngine.prototype.start = function (c, s) {\n        this.shape = new marquee_1[\"default\"]();\n        this.shape.pts = [s.pinnedCursorPoint, s.cursorPoint];\n        this.initialPts = util.clone(this.shape.pts);\n        c.addShape(this.shape);\n    };\n    MarqueeEngine.prototype.stop = function () {\n        this.shape.stop();\n    };\n    MarqueeEngine.prototype.run = function (s) {\n        this.shape.pts = [s.pinnedCursorPoint, s.cursorPoint];\n    };\n    return MarqueeEngine;\n}(Engine));\n// function addLayer(layers: Layers, shape): Layer {\n//   const layer = new Layer();\n//   layer.humanName = \"Rectangle\";\n//   layer.type = LayerType.Rect;\n//   layer.shape = shape;\n//   layers.addLayer(layer);\n//   layers.render();\n//\n//   return layer;\n// }\n// function what(cursor: Point, layers: Layers): Selection | null {\n//   const list = layers.getLayers();\n//\n//   for (let i = 0, l = list.length; i < l; i++) {\n//     const layer = list[i];\n//     const shape = list[i].shape;\n//\n//     if (shape.pts.length > 1) {\n//       if (util.withinBound(cursor, shape.pts)) {\n//         return {\n//           layer,\n//           area: Area.Corner\n//         };\n//       }\n//     }\n//   }\n// }\n// class RectangleEngine extends Engine {\n//   start(c: Canvas, s: State) {\n//     const shape = new Marquee(c);\n//     const layer = new Layer();\n//     layer.humanName = \"Rectangle\";\n//     layer.type = LayerType.Rect;\n//     layer.shape = shape;\n//\n//     s.selection = what(canvas.grid.closestPt, layers);\n//     this.initialPts = util.clone(s.selection.layer.shape.pts);\n//   }\n//   stop() {}\n// }\nvar QUICK_CLICK_MS = 200;\nvar Shell = /** @class */ (function () {\n    function Shell(os, state) {\n        this.state = state;\n        this.os = os;\n    }\n    Shell.prototype.dombind = function () {\n        this.os.canvas.onMouseDown(this.handleMouseDown.bind(this));\n        this.os.canvas.onMouseUp(this.handleMouseUp.bind(this));\n        this.os.canvas.onMouseMove(this.handleMouseMove.bind(this));\n        this.os.toolbar.onModeChange = this.handleChangeMode.bind(this);\n    };\n    Shell.prototype.handleChangeMode = function (m) {\n        this.state.mode = m;\n        this.os.toolbar.hide();\n    };\n    Shell.prototype.handleMouseDown = function (e) {\n        this.os.toolbar.hide();\n        this.state.downAt = new Date().getTime();\n        this.state.pinnedCursorPoint = this.os.canvas.grid.closestPt;\n        this.state.cursorPoint = this.os.canvas.grid.closestPt;\n        if (this.state.mode === types_1.Mode.Marquee) {\n            this.activity = new MarqueeEngine();\n            this.activity.start(this.os.canvas, this.state);\n        }\n    };\n    Shell.prototype.handleMouseUp = function (e) {\n        if (new Date().getTime() - this.state.downAt < QUICK_CLICK_MS) {\n            this.os.toolbar.show(this.os.canvas.grid.closestPt);\n        }\n        else {\n            if (this.activity) {\n                this.activity.stop();\n                this.activity = null;\n            }\n        }\n    };\n    Shell.prototype.handleMouseMove = function (e) {\n        this.state.cursorPoint = this.os.canvas.grid.closestPt;\n        if (this.activity) {\n            this.activity.run(this.state);\n        }\n    };\n    return Shell;\n}());\n//# sourceMappingURL=interactions.js.map","\"use strict\";\nvar __extends = (this && this.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    }\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nexports.__esModule = true;\nvar dom = require(\"./dom\");\nvar component_1 = require(\"./component\");\nvar types_1 = require(\"./types\");\nvar Layers = /** @class */ (function (_super) {\n    __extends(Layers, _super);\n    function Layers() {\n        var _this = _super !== null && _super.apply(this, arguments) || this;\n        _this.layers = [];\n        return _this;\n    }\n    Layers.prototype.addLayer = function (layer) {\n        this.layers.push(layer);\n        this.render();\n    };\n    Layers.prototype.getLayers = function () {\n        return this.layers;\n    };\n    Layers.prototype.render = function () {\n        var _a;\n        var section = dom.section(\"layers\");\n        var ul = dom.ul(\"layer-list\");\n        section.style.width = \"165px\";\n        section.style.background = this.colorPalette.layersBg;\n        section.style.color = this.colorPalette.layersColor;\n        var countHashMap = (_a = {},\n            _a[types_1.LayerType.Rect] = 0,\n            _a[types_1.LayerType.Line] = 0,\n            _a[types_1.LayerType.Text] = 0,\n            _a);\n        this.layers.forEach(function (l) {\n            var li = dom.li(\"layer-list-item\");\n            li.innerHTML = l.humanName + \" \" + ++countHashMap[l.type];\n            ul.appendChild(li);\n        });\n        section.appendChild(ul);\n        this.rendered(section);\n    };\n    return Layers;\n}(component_1[\"default\"]));\nexports[\"default\"] = Layers;\n//# sourceMappingURL=layers.js.map","\"use strict\";\nvar __extends = (this && this.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    }\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nexports.__esModule = true;\nvar shape_1 = require(\"./shape\");\nvar Marquee = /** @class */ (function (_super) {\n    __extends(Marquee, _super);\n    function Marquee() {\n        return _super !== null && _super.apply(this, arguments) || this;\n    }\n    Marquee.prototype.render = function (ctx, colors) {\n        if (!this.animating || this.pts.length < 2) {\n            return;\n        }\n        ctx.beginPath();\n        ctx.moveTo(this.pts[0][0], this.pts[0][1]);\n        ctx.lineTo(this.pts[0][0], this.pts[1][1]);\n        ctx.lineTo(this.pts[1][0], this.pts[1][1]);\n        ctx.lineTo(this.pts[1][0], this.pts[0][1]);\n        ctx.lineWidth = 1;\n        ctx.closePath();\n        ctx.strokeStyle = \"#ffffff\";\n        // this.canvas.ctx.strokeStyle = c.shapeColor;\n        ctx.stroke();\n    };\n    return Marquee;\n}(shape_1[\"default\"]));\nexports[\"default\"] = Marquee;\n//# sourceMappingURL=marquee.js.map","\"use strict\";\nexports.__esModule = true;\nvar Shape = /** @class */ (function () {\n    function Shape() {\n        this.pts = [];\n        this.animating = true;\n    }\n    Shape.prototype.stop = function () {\n        this.animating = false;\n    };\n    Shape.prototype.play = function () {\n        this.animating = true;\n    };\n    return Shape;\n}());\nexports[\"default\"] = Shape;\n//# sourceMappingURL=shape.js.map","\"use strict\";\nvar __extends = (this && this.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    }\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nexports.__esModule = true;\nvar dom = require(\"./dom\");\nvar component_1 = require(\"./component\");\nvar types_1 = require(\"./types\");\nvar LEFT_MARGIN = 180;\nvar Toolbar = /** @class */ (function (_super) {\n    __extends(Toolbar, _super);\n    function Toolbar() {\n        return _super !== null && _super.apply(this, arguments) || this;\n    }\n    Toolbar.prototype.handleClickEvent = function (m) {\n        var _this = this;\n        return function () {\n            _this.mode = types_1.Mode.Marquee;\n            // this.mode = this.mode === m ? Mode.Marquee : m;\n            _this.onModeChange(_this.mode);\n        };\n    };\n    Toolbar.prototype.render = function () {\n        var el = dom.section(\"toolbar\");\n        var rectButton = dom.button();\n        var lineButton = dom.button();\n        var textButton = dom.button();\n        rectButton.style.backgroundImage = \"url(\" + icons.rectangleDark + \")\";\n        lineButton.style.backgroundImage = \"url(\" + icons.lineDark + \")\";\n        textButton.style.backgroundImage = \"url(\" + icons.textDark + \")\";\n        el.style.background = this.colorPalette.toolbarBg;\n        el.style.position = \"absolute\";\n        rectButton.addEventListener(\"click\", this.handleClickEvent(types_1.Mode.Rectangle));\n        lineButton.addEventListener(\"click\", this.handleClickEvent(types_1.Mode.Line));\n        textButton.addEventListener(\"click\", this.handleClickEvent(types_1.Mode.Text));\n        el.appendChild(rectButton);\n        el.appendChild(lineButton);\n        el.appendChild(textButton);\n        if (this.showing) {\n            el.style.display = \"absolute\";\n            var d = dom.getDimensions(el, true);\n            el.style.left = LEFT_MARGIN + this.position[0] - d.width / 2 + \"px\";\n            el.style.top = this.position[1] - d.height - 26 + \"px\";\n        }\n        else {\n            el.style.display = \"none\";\n        }\n        this.rendered(el);\n    };\n    Toolbar.prototype.show = function (pos) {\n        this.showing = true;\n        this.position = pos;\n        this.render();\n    };\n    Toolbar.prototype.hide = function () {\n        this.showing = false;\n        this.render();\n    };\n    return Toolbar;\n}(component_1[\"default\"]));\nexports[\"default\"] = Toolbar;\nvar icons = {\n    textDark: \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAwAAAAgCAYAAAAmG5mqAAAACXBIWXMAABYlAAAWJQFJUiTwAAAAbklEQVQ4je2UwQ2AIBAEF0MBdrKWoJVrCWwndoCB4EMBkT/zu2M3Fz5jvPfowYYsyRnA0ug5SadNQwjvWeTJBuCYsnWD4h9IxqUk837rvjAKo1BhFEahQvQSyfWP+ST1m+92q0vu/CJkyqqsAuACdNIeCAV1+NEAAAAASUVORK5CYII=\",\n    lineDark: \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACQAAAAkCAYAAADhAJiYAAAABGdBTUEAALGPC/xhBQAAAf9JREFUWAntlztOw0AQhmOLInJJC3dIUiaipKEmUCKEEC0dDTWHQIpSUPI4AdS2qJyEM9BC5wrF/IMYa2PvY5x4kyaWrH3Nznyefz2yW63tZc9AYF/2u9rpdPbyPD9GlP3ZbHZD0Xb8hqx6Z4ggCE4BM4AFJeWaLdcCRBAAGALghCHQMkOOtRceeAMqQwBAezwAE0+n008vQFIIDk4tQB/V8coZWgZCAViQi+aXAloRouApy1ULqCmIggYdAD2pYyeQDwgFAMcnf1bGf12tZL1e72g+n99iwwC39u0oO6o71slFPkKdo3a7/Y75CLcXGIqpk4vmtUBJknxFUXSITSkZebi0clEcLRAt+IQyyWUF8gllkssJ5AnKKJcIqGkom1xioCahbHLVAmoIyipXbSDaEMfxN57yg/p1L5dc5E9bqU2BqGp3u90R2jOTjW3eJRftNdahsmMF5oLXwjB8QBBp8XTKJQbSwQBknKbpubSiS+QSAZlgJpPJJYLk0ooO28qnBmdaba2SuWDYkQBKJJc1Q1IYCZRULiNQXRgXlFQuLdCyMBYosVzkY+EDbFUYhqK23+/vZln2hm6G/64Ddc3WLw51kzAUkA86atWdDaC8VmQIH/T3gLpiA+g+5leb59bRFhnCk7wC4oeCbgqm8sD42xj+Z6rIXMVoO7HhDPwC/Y58qqnpGUQAAAAASUVORK5CYII=\",\n    rectangleDark: \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAC4AAAAiCAYAAAAge+tMAAAABGdBTUEAALGPC/xhBQAAAKpJREFUWAntl0EOgCAQA8HwHv7/Dj6k4dAEe+JAYKv1sgoEdodaQq613ml4Wmt5+ExR+68xSaX3opRszxUKkCWeUQHIs8bRfjpynrLEZTTOSpAlflq6/1v/dUpGLv87rsKV8N8bdRdkXcU+HlVSzmsVAfv4KpKz8xT7+CyqRePs44tAepqwBOzju7fGPr6dOC+Ik5RvQmjH+N39WBdR9gZ0dXJMD1VFjrLEH/xAUETson4YAAAAAElFTkSuQmCC\"\n};\n//# sourceMappingURL=toolbar.js.map","\"use strict\";\nexports.__esModule = true;\nvar ActionType;\n(function (ActionType) {\n    ActionType[ActionType[\"Moving\"] = 0] = \"Moving\";\n    ActionType[ActionType[\"Enlarging\"] = 1] = \"Enlarging\";\n    ActionType[ActionType[\"Resizing\"] = 2] = \"Resizing\";\n})(ActionType = exports.ActionType || (exports.ActionType = {}));\nvar LayerType;\n(function (LayerType) {\n    LayerType[LayerType[\"Rect\"] = 0] = \"Rect\";\n    LayerType[LayerType[\"Line\"] = 1] = \"Line\";\n    LayerType[LayerType[\"Text\"] = 2] = \"Text\";\n})(LayerType = exports.LayerType || (exports.LayerType = {}));\nvar Mode;\n(function (Mode) {\n    Mode[Mode[\"Marquee\"] = 0] = \"Marquee\";\n    Mode[Mode[\"Rectangle\"] = 1] = \"Rectangle\";\n    Mode[Mode[\"Line\"] = 2] = \"Line\";\n    Mode[Mode[\"Text\"] = 3] = \"Text\";\n})(Mode = exports.Mode || (exports.Mode = {}));\n//# sourceMappingURL=types.js.map","\"use strict\";\nexports.__esModule = true;\nfunction pt(x, y) {\n    if (x === undefined || y === undefined) {\n        return new Float32Array([0, 0]);\n    }\n    return new Float32Array([x, y]);\n}\nexports.pt = pt;\nfunction within(p, a, b) {\n    return p >= Math.min(a, b) && p <= Math.max(a, b);\n}\nexports.within = within;\nfunction withinBound(pt, rect) {\n    if (!within(pt[0], rect[0][0], rect[1][0]) ||\n        !within(pt[1], rect[0][1], rect[1][1])) {\n        return false;\n    }\n    return true;\n}\nexports.withinBound = withinBound;\nfunction add(a, b) {\n    if (b instanceof Array) {\n        return b.map(function (v) { return pt(v[0] + a[0], v[1] + a[1]); });\n    }\n    else if (b instanceof Float32Array) {\n        return pt(a[0] + b[0], a[1] + b[1]);\n    }\n}\nexports.add = add;\nfunction subtract(a, b) {\n    if (b instanceof Array) {\n        return b.map(function (v) { return pt(v[0] - a[0], v[1] - a[1]); });\n    }\n    else if (b instanceof Float32Array) {\n        return pt(a[0] - b[0], a[1] - b[1]);\n    }\n}\nexports.subtract = subtract;\nfunction clone(a) {\n    return a.map(function (v) { return pt(v[0], v[1]); });\n}\nexports.clone = clone;\nfunction multiply(a, b) {\n    return b.map(function (v) { return pt(v[0] * a[0], v[1] * a[1]); });\n}\nexports.multiply = multiply;\nfunction dot() {\n    var pts = [];\n    for (var _i = 0; _i < arguments.length; _i++) {\n        pts[_i] = arguments[_i];\n    }\n    var init = new Float32Array([0, 0]);\n    return pts.reduce(function (acc, p) { return multiply(acc, p); }, init);\n}\nexports.dot = dot;\n//# sourceMappingURL=util.js.map"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;ACtHA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;ACfA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AChCA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;ACtCA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AC7EA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;ACpEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AC/IA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;ACvDA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;ACvCA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AChBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AC5EA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;ACrBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;"}